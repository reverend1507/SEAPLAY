<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SeePlay - World's Best Casino App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #1a237e;
            --secondary: #00b0ff;
            --accent: #ff4081;
            --dark: #0d1b2a;
            --light: #f5f5f5;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --gray: #9e9e9e;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--dark);
            color: var(--light);
            overflow-x: hidden;
        }
        
        .container {
            max-width: 480px;
            margin: 0 auto;
            background-color: var(--dark);
            min-height: 100vh;
            position: relative;
            padding-bottom: 70px;
        }
        
        /* Header Styles */
        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 15px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .logo i {
            font-size: 28px;
        }
        
        .time-display {
            font-size: 14px;
            margin-top: 5px;
            opacity: 0.9;
        }
        
        .winning-users {
            margin-top: 10px;
            font-size: 12px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .winning-user {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Main Content */
        .main-content {
            padding: 15px;
        }
        
        /* Balance Card */
        .balance-card {
            background: linear-gradient(135deg, var(--primary), #3949ab);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        
        .balance-title {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .balance-amount {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .balance-stats {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 14px;
        }
        
        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 5px;
            margin-bottom: 20px;
        }
        
        .nav-tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .nav-tab.active {
            background-color: var(--secondary);
            color: var(--dark);
        }
        
        /* Section Headers */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0 15px;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: bold;
        }
        
        .view-all {
            font-size: 14px;
            color: var(--secondary);
        }
        
        /* Games Grid */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .game-card {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px 10px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            background-color: rgba(255, 255, 255, 0.15);
        }
        
        .game-icon {
            font-size: 24px;
            margin-bottom: 8px;
            color: var(--secondary);
        }
        
        .game-name {
            font-size: 12px;
            font-weight: 500;
        }
        
        /* Promo Banner */
        .promo-banner {
            background: linear-gradient(135deg, var(--accent), #ff79a6);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        
        .promo-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .promo-subtitle {
            font-size: 14px;
            margin-bottom: 15px;
            opacity: 0.9;
        }
        
        .promo-button {
            background-color: var(--light);
            color: var(--dark);
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .promo-button:hover {
            transform: scale(1.05);
        }
        
        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(13, 27, 42, 0.95);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            max-width: 480px;
            margin: 0 auto;
        }
        
        .nav-item {
            text-align: center;
            color: var(--gray);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }
        
        .nav-item.active {
            color: var(--secondary);
        }
        
        .nav-icon {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        /* Auth Screens */
        .auth-screen {
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        
        .auth-logo {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .auth-form {
            width: 100%;
            max-width: 350px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--light);
            font-size: 16px;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--secondary);
        }
        
        .auth-button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .auth-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .auth-link {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
        }
        
        .auth-link a {
            color: var(--secondary);
            text-decoration: none;
        }
        
        /* Game Screens */
        .game-screen {
            padding: 15px;
            min-height: 100vh;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .game-title {
            font-size: 24px;
            font-weight: bold;
        }
        
        .game-balance {
            font-size: 18px;
            font-weight: bold;
        }
        
        .game-area {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .bet-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .bet-amount {
            font-size: 18px;
            font-weight: bold;
        }
        
        .bet-button {
            background-color: var(--secondary);
            color: var(--dark);
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .bet-button:hover {
            transform: scale(1.05);
        }
        
        .bet-button:disabled {
            background-color: var(--gray);
            cursor: not-allowed;
        }
        
        /* Mines Specific */
        .mines-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .mine-cell {
            width: 50px;
            height: 50px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .mine-cell.revealed {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .mine-cell.mine {
            background-color: var(--danger);
        }
        
        .mine-cell.gem {
            background-color: var(--success);
        }
        
        .mines-settings {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .mines-setting {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .mines-setting-label {
            font-size: 12px;
            margin-bottom: 5px;
            opacity: 0.8;
        }
        
        .mines-setting-value {
            font-size: 16px;
            font-weight: bold;
        }
        
        .mines-setting-controls {
            display: flex;
            gap: 10px;
        }
        
        .mines-control-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--light);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .mines-multiplier-display {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .mines-cashout-display {
            font-size: 16px;
            margin-bottom: 10px;
            text-align: center;
        }
        
        /* Admin Panel */
        .admin-panel {
            padding: 15px;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .admin-title {
            font-size: 24px;
            font-weight: bold;
        }
        
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .admin-stat {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .admin-stat-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .admin-stat-label {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .admin-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .admin-action {
            background-color: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            padding: 12px;
            color: var(--light);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .admin-action:hover {
            background-color: var(--secondary);
            color: var(--dark);
        }
        
        .users-list {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .user-info {
            flex: 1;
        }
        
        .user-name {
            font-weight: bold;
        }
        
        .user-email {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .user-balance {
            font-weight: bold;
            margin-right: 10px;
        }
        
        .user-actions {
            display: flex;
            gap: 5px;
        }
        
        .user-action {
            background: none;
            border: none;
            color: var(--light);
            cursor: pointer;
            padding: 5px;
        }
        
        /* Profile Page */
        .profile-section {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .profile-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-right: 15px;
        }
        
        .profile-info {
            flex: 1;
        }
        
        .profile-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .profile-email {
            font-size: 14px;
            opacity: 0.8;
        }
        
        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .profile-stat {
            text-align: center;
        }
        
        .profile-stat-value {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .profile-stat-label {
            font-size: 12px;
            opacity: 0.8;
        }
        
        /* Referral Section */
        .referral-section {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .referral-list {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .referral-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        /* Transaction History */
        .transaction-section {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .transaction-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .transaction-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .transaction-type {
            font-weight: bold;
        }
        
        .transaction-amount.positive {
            color: var(--success);
        }
        
        .transaction-amount.negative {
            color: var(--danger);
        }
        
        /* Inbox Section */
        .inbox-section {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .message-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .message-item {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .message-sender {
            font-weight: bold;
        }
        
        .message-time {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .message-content {
            font-size: 14px;
        }
        
        /* Hidden class for toggling screens */
        .hidden {
            display: none;
        }
        
        /* Logout Button */
        .logout-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: var(--light);
            cursor: pointer;
            font-size: 16px;
        }
        
        /* Back Button */
        .back-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: none;
            border: none;
            color: var(--light);
            cursor: pointer;
            font-size: 16px;
        }
        
        /* Chart Container */
        .chart-container {
            width: 100%;
            height: 200px;
            margin-top: 15px;
        }
        
        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="auth-screen">
        <div class="auth-logo">
            <i class="fas fa-water"></i> SeePlay
        </div>
        <div class="auth-form">
            <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" id="loginEmail" class="form-input" placeholder="Enter your email">
            </div>
            <div class="form-group">
                <label class="form-label">Password</label>
                <input type="password" id="loginPassword" class="form-input" placeholder="Enter your password">
            </div>
            <button id="loginButton" class="auth-button">
                <span id="loginButtonText">Login</span>
                <span id="loginButtonSpinner" class="loading-spinner hidden"></span>
            </button>
            <div class="auth-link">
                Don't have an account? <a href="#" id="showRegister">Register</a>
            </div>
            <div class="auth-link">
                <a href="#" id="showAdminLogin">Login as Lord</a>
            </div>
        </div>
    </div>
    
    <!-- Register Screen -->
    <div id="registerScreen" class="auth-screen hidden">
        <div class="auth-logo">
            <i class="fas fa-water"></i> SeePlay
        </div>
        <div class="auth-form">
            <div class="form-group">
                <label class="form-label">Full Name</label>
                <input type="text" id="registerName" class="form-input" placeholder="Enter your full name">
            </div>
            <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" id="registerEmail" class="form-input" placeholder="Enter your email">
            </div>
            <div class="form-group">
                <label class="form-label">Password</label>
                <input type="password" id="registerPassword" class="form-input" placeholder="Create a password">
            </div>
            <div class="form-group">
                <label class="form-label">Confirm Password</label>
                <input type="password" id="registerConfirmPassword" class="form-input" placeholder="Confirm your password">
            </div>
            <div class="form-group">
                <label class="form-label">4-Digit PIN</label>
                <input type="password" id="registerPin" class="form-input" placeholder="Create a 4-digit PIN" maxlength="4">
            </div>
            <div class="form-group">
                <label class="form-label">Age</label>
                <input type="number" id="registerAge" class="form-input" placeholder="Enter your age">
            </div>
            <div class="form-group">
                <label class="form-label">Country</label>
                <select id="registerCountry" class="form-input">
                    <option value="">Select your country</option>
                    <option value="nigeria">Nigeria</option>
                    <option value="ghana">Ghana</option>
                    <option value="south-africa">South Africa</option>
                    <option value="kenya">Kenya</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Referral Code (Optional)</label>
                <input type="text" id="referralCodeInput" class="form-input" placeholder="Enter referral code if any">
            </div>
            <button id="registerButton" class="auth-button">
                <span id="registerButtonText">Create Account</span>
                <span id="registerButtonSpinner" class="loading-spinner hidden"></span>
            </button>
            <div class="auth-link">
                Already have an account? <a href="#" id="showLogin">Login</a>
            </div>
        </div>
    </div>
    
    <!-- Admin Login Screen -->
    <div id="adminLoginScreen" class="auth-screen hidden">
        <div class="auth-logo">
            <i class="fas fa-crown"></i> Lord Panel
        </div>
        <div class="auth-form">
            <div class="form-group">
                <label class="form-label">Admin Email</label>
                <input type="email" id="adminEmail" class="form-input" placeholder="Enter admin email">
            </div>
            <div class="form-group">
                <label class="form-label">Password</label>
                <input type="password" id="adminPassword" class="form-input" placeholder="Enter admin password">
            </div>
            <button id="adminLoginButton" class="auth-button">
                <span id="adminLoginButtonText">Login as Lord</span>
                <span id="adminLoginButtonSpinner" class="loading-spinner hidden"></span>
            </button>
            <div class="auth-link">
                <a href="#" id="showUserLogin">Back to User Login</a>
            </div>
        </div>
    </div>
    
    <!-- Main App Screen -->
    <div id="appScreen" class="container hidden">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-water"></i> SeePlay
            </div>
            <div class="time-display" id="currentTime">9:25</div>
            <div class="winning-users" id="winningUsers">
                <!-- Winning users will be displayed here -->
            </div>
            <button class="logout-btn" id="logoutButton">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Balance Card -->
            <div class="balance-card">
                <div class="balance-title">Your Balance</div>
                <div class="balance-amount" id="userBalance">0 SEE</div>
                <div class="balance-stats">
                    <div class="stat-item">
                        <div>USD Value</div>
                        <div class="stat-value" id="usdValue">$0.00</div>
                    </div>
                    <div class="stat-item">
                        <div>Free Bets</div>
                        <div class="stat-value" id="freeBets">0</div>
                    </div>
                    <div class="stat-item">
                        <div>Referrals</div>
                        <div class="stat-value" id="referralsCount">0</div>
                    </div>
                </div>
            </div>
            
            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <div class="nav-tab active" data-tab="games">Games</div>
                <div class="nav-tab" data-tab="transfer">Transfer</div>
                <div class="nav-tab" data-tab="history">History</div>
                <div class="nav-tab" data-tab="profile">Profile</div>
            </div>
            
            <!-- Games Section -->
            <div id="gamesSection" class="tab-content">
                <div class="section-header">
                    <div class="section-title">Casino Games</div>
                </div>
                
                <div class="games-grid">
                    <div class="game-card" data-game="mines">
                        <div class="game-icon"><i class="fas fa-bomb"></i></div>
                        <div class="game-name">Mines</div>
                    </div>
                </div>
                
                <div class="promo-banner">
                    <div class="promo-title">CLAIM FREE BETS</div>
                    <div class="promo-subtitle">GET 3 FREE SEE COINS ON SIGNUP</div>
                    <button class="promo-button" id="claimBonusBtn">CLAIM NOW</button>
                </div>
            </div>
            
            <!-- Transfer Section -->
            <div id="transferSection" class="tab-content hidden">
                <div class="section-header">
                    <div class="section-title">Transfer SEE Coins</div>
                </div>
                
                <div class="profile-section">
                    <div class="form-group">
                        <label class="form-label">Recipient Email</label>
                        <input type="email" id="transferEmail" class="form-input" placeholder="Enter recipient's email">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Amount (Min. 1 SEE)</label>
                        <input type="number" id="transferAmount" class="form-input" placeholder="Enter amount" min="1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">4-Digit PIN</label>
                        <input type="password" id="transferPin" class="form-input" placeholder="Enter your PIN" maxlength="4">
                    </div>
                    <button class="auth-button" id="transferButton">Send SEE</button>
                </div>
            </div>
            
            <!-- History Section -->
            <div id="historySection" class="tab-content hidden">
                <div class="section-header">
                    <div class="section-title">Transaction History</div>
                </div>
                
                <div class="transaction-section">
                    <div class="transaction-list" id="transactionList">
                        <!-- Transactions will be listed here -->
                    </div>
                </div>
            </div>
            
            <!-- Profile Section -->
            <div id="profileSection" class="tab-content hidden">
                <div class="profile-section">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="profile-info">
                            <div class="profile-name" id="profileUserName">User Name</div>
                            <div class="profile-email" id="profileUserEmail">user@example.com</div>
                        </div>
                    </div>
                    
                    <div class="profile-stats">
                        <div class="profile-stat">
                            <div class="profile-stat-value" id="profileGamesPlayed">0</div>
                            <div class="profile-stat-label">Games Played</div>
                        </div>
                        <div class="profile-stat">
                            <div class="profile-stat-value" id="profileWins">0</div>
                            <div class="profile-stat-label">Wins</div>
                        </div>
                        <div class="profile-stat">
                            <div class="profile-stat-value" id="profileReferrals">0</div>
                            <div class="profile-stat-label">Referrals</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Your Referral Code</label>
                        <input type="text" class="form-input" id="userReferralCode" readonly>
                    </div>
                    <button class="auth-button" style="margin-top: 10px;" id="copyReferralBtn">Copy Referral Code</button>
                </div>
                
                <div class="referral-section">
                    <div class="section-header">
                        <div class="section-title">Your Referrals</div>
                    </div>
                    <div class="referral-list" id="referralList">
                        <!-- Referrals will be listed here -->
                    </div>
                    <button class="auth-button" id="claimReferralBtn" disabled>Claim Referral Bonus (0/10)</button>
                </div>
                
                <div class="profile-section">
                    <div class="section-header">
                        <div class="section-title">Change PIN</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Current PIN</label>
                        <input type="password" id="currentPin" class="form-input" placeholder="Enter current PIN" maxlength="4">
                    </div>
                    <div class="form-group">
                        <label class="form-label">New PIN</label>
                        <input type="password" id="newPin" class="form-input" placeholder="Enter new 4-digit PIN" maxlength="4">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirm New PIN</label>
                        <input type="password" id="confirmNewPin" class="form-input" placeholder="Confirm new PIN" maxlength="4">
                    </div>
                    <button class="auth-button" id="changePinButton">Change PIN</button>
                </div>
                
                <div class="profile-section">
                    <div class="section-header">
                        <div class="section-title">Price Chart</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="priceChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <div class="nav-item active" data-nav="home">
                <div class="nav-icon"><i class="fas fa-home"></i></div>
                <div>Home</div>
            </div>
            <div class="nav-item" data-nav="games">
                <div class="nav-icon"><i class="fas fa-gamepad"></i></div>
                <div>Games</div>
            </div>
            <div class="nav-item" data-nav="transfer">
                <div class="nav-icon"><i class="fas fa-exchange-alt"></i></div>
                <div>Transfer</div>
            </div>
            <div class="nav-item" data-nav="history">
                <div class="nav-icon"><i class="fas fa-history"></i></div>
                <div>History</div>
            </div>
            <div class="nav-item" data-nav="profile">
                <div class="nav-icon"><i class="fas fa-user"></i></div>
                <div>Profile</div>
            </div>
        </div>
    </div>
    
    <!-- Game Screens -->
    <div id="gameScreens" class="hidden">
        <!-- Mines Game -->
        <div id="minesGame" class="game-screen hidden">
            <button class="back-btn" id="minesBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="game-header">
                <div class="game-title">Mines</div>
                <div class="game-balance" id="minesBalance">0 SEE</div>
            </div>
            
            <div class="mines-settings">
                <div class="mines-setting">
                    <div class="mines-setting-label">Mines</div>
                    <div class="mines-setting-value" id="minesCount">3</div>
                    <div class="mines-setting-controls">
                        <button class="mines-control-btn" id="decreaseMines">-</button>
                        <button class="mines-control-btn" id="increaseMines">+</button>
                    </div>
                </div>
                <div class="mines-setting">
                    <div class="mines-setting-label">Bet Amount</div>
                    <div class="mines-setting-value" id="minesBetAmountDisplay">1.00 SEE</div>
                    <div class="mines-setting-controls">
                        <button class="mines-control-btn" id="decreaseBet">-</button>
                        <button class="mines-control-btn" id="increaseBet">+</button>
                    </div>
                </div>
            </div>
            
            <div class="game-area">
                <div class="mines-multiplier-display" id="minesMultiplierDisplay">Multiplier: 1.00x</div>
                <div class="mines-cashout-display" id="minesCashoutDisplay">Cashout: 1.00 SEE</div>
                <div class="mines-grid" id="minesGrid">
                    <!-- Mines grid will be generated here -->
                </div>
            </div>
            <div class="bet-controls">
                <button class="bet-button" id="minesPlayButton">PLAY</button>
                <button class="bet-button" id="minesCashoutButton" disabled>CASHOUT</button>
            </div>
        </div>
    </div>
    
    <!-- Admin Panel -->
    <div id="adminPanel" class="container hidden">
        <div class="header">
            <div class="logo">
                <i class="fas fa-crown"></i> Lord Panel
            </div>
            <button class="logout-btn" id="adminLogoutButton">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
        
        <div class="admin-panel">
            <div class="admin-header">
                <div class="admin-title">Admin Dashboard</div>
            </div>
            
            <div class="admin-stats">
                <div class="admin-stat">
                    <div class="admin-stat-value" id="totalUsers">0</div>
                    <div class="admin-stat-label">Total Users</div>
                </div>
                <div class="admin-stat">
                    <div class="admin-stat-value" id="totalBalance">0 SEE</div>
                    <div class="admin-stat-label">User Balances</div>
                </div>
                <div class="admin-stat">
                    <div class="admin-stat-value" id="vaultBalance">50,000,000,000 SEE</div>
                    <div class="admin-stat-label">Vault Balance</div>
                </div>
                <div class="admin-stat">
                    <div class="admin-stat-value" id="activeGames">0</div>
                    <div class="admin-stat-label">Active Games</div>
                </div>
            </div>
            
            <div class="admin-actions">
                <button class="admin-action" id="addCoinsBtn">Add Coins to User</button>
                <button class="admin-action" id="banUserBtn">Ban User</button>
                <button class="admin-action" id="messageUserBtn">Message User</button>
                <button class="admin-action" id="setPriceBtn">Set SEE Price</button>
            </div>
            
            <div class="section-header">
                <div class="section-title">All Users</div>
            </div>
            
            <div class="users-list" id="usersList">
                <!-- Users will be listed here -->
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDDruUr6ONHIqZqNmvbnSfMF3nTlbejcvU",
            authDomain: "seaplay-6a197.firebaseapp.com",
            projectId: "seaplay-6a197",
            storageBucket: "seaplay-6a197.firebasestorage.app",
            messagingSenderId: "419084403907",
            appId: "1:419084403907:web:2ef95d7c804c92f4808e76",
            measurementId: "G-LDY3ZLKJFF"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // DOM Elements
        const loginScreen = document.getElementById('loginScreen');
        const registerScreen = document.getElementById('registerScreen');
        const adminLoginScreen = document.getElementById('adminLoginScreen');
        const appScreen = document.getElementById('appScreen');
        const adminPanel = document.getElementById('adminPanel');
        const gameScreens = document.getElementById('gameScreens');
        
        // Auth buttons
        const loginButton = document.getElementById('loginButton');
        const loginButtonText = document.getElementById('loginButtonText');
        const loginButtonSpinner = document.getElementById('loginButtonSpinner');
        const registerButton = document.getElementById('registerButton');
        const registerButtonText = document.getElementById('registerButtonText');
        const registerButtonSpinner = document.getElementById('registerButtonSpinner');
        const adminLoginButton = document.getElementById('adminLoginButton');
        const adminLoginButtonText = document.getElementById('adminLoginButtonText');
        const adminLoginButtonSpinner = document.getElementById('adminLoginButtonSpinner');
        const logoutButton = document.getElementById('logoutButton');
        const adminLogoutButton = document.getElementById('adminLogoutButton');
        
        // Navigation links
        const showRegister = document.getElementById('showRegister');
        const showLogin = document.getElementById('showLogin');
        const showAdminLogin = document.getElementById('showAdminLogin');
        const showUserLogin = document.getElementById('showUserLogin');
        
        // Game elements
        const minesPlayButton = document.getElementById('minesPlayButton');
        const minesCashoutButton = document.getElementById('minesCashoutButton');
        const minesCashoutDisplay = document.getElementById('minesCashoutDisplay');
        const minesMultiplierDisplay = document.getElementById('minesMultiplierDisplay');
        const minesGrid = document.getElementById('minesGrid');
        const minesBackBtn = document.getElementById('minesBackBtn');
        const minesCount = document.getElementById('minesCount');
        const minesBetAmountDisplay = document.getElementById('minesBetAmountDisplay');
        const decreaseMines = document.getElementById('decreaseMines');
        const increaseMines = document.getElementById('increaseMines');
        const decreaseBet = document.getElementById('decreaseBet');
        const increaseBet = document.getElementById('increaseBet');
        
        // Transfer elements
        const transferButton = document.getElementById('transferButton');
        const transferEmail = document.getElementById('transferEmail');
        const transferAmount = document.getElementById('transferAmount');
        const transferPin = document.getElementById('transferPin');
        
        // Profile elements
        const profileUserName = document.getElementById('profileUserName');
        const profileUserEmail = document.getElementById('profileUserEmail');
        const profileGamesPlayed = document.getElementById('profileGamesPlayed');
        const profileWins = document.getElementById('profileWins');
        const profileReferrals = document.getElementById('profileReferrals');
        const userReferralCode = document.getElementById('userReferralCode');
        const copyReferralBtn = document.getElementById('copyReferralBtn');
        const referralList = document.getElementById('referralList');
        const claimReferralBtn = document.getElementById('claimReferralBtn');
        const changePinButton = document.getElementById('changePinButton');
        const currentPin = document.getElementById('currentPin');
        const newPin = document.getElementById('newPin');
        const confirmNewPin = document.getElementById('confirmNewPin');
        
        // Admin elements
        const addCoinsBtn = document.getElementById('addCoinsBtn');
        const banUserBtn = document.getElementById('banUserBtn');
        const messageUserBtn = document.getElementById('messageUserBtn');
        const setPriceBtn = document.getElementById('setPriceBtn');
        const usersList = document.getElementById('usersList');
        
        // Other elements
        const claimBonusBtn = document.getElementById('claimBonusBtn');
        const transactionList = document.getElementById('transactionList');
        const winningUsers = document.getElementById('winningUsers');
        const usdValue = document.getElementById('usdValue');
        const freeBets = document.getElementById('freeBets');
        const referralsCount = document.getElementById('referralsCount');
        
        // App state
        let currentUser = null;
        let isAdmin = false;
        let userBalance = 0;
        let currentGame = null;
        let gameIntervals = {};
        let adminVaultBalance = 50000000000; // 50B SEE
        let seePrice = 1.01; // Default SEE price
        
        // Mines game state
        let minesGameState = {
            betAmount: 1.00,
            minesCount: 3,
            grid: [],
            revealed: [],
            gameActive: false,
            cashoutMultiplier: 1.0,
            multiplierHistory: [1.0]
        };
        
        // Price chart
        let priceChart = null;
        
        // Update current time
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            document.getElementById('currentTime').textContent = timeString;
        }
        
        setInterval(updateTime, 1000);
        updateTime();
        
        // Show/Hide Screens
        function showScreen(screen) {
            loginScreen.classList.add('hidden');
            registerScreen.classList.add('hidden');
            adminLoginScreen.classList.add('hidden');
            appScreen.classList.add('hidden');
            adminPanel.classList.add('hidden');
            gameScreens.classList.add('hidden');
            
            screen.classList.remove('hidden');
        }
        
        // Show loading state for buttons
        function showLoading(buttonText, buttonSpinner) {
            buttonText.classList.add('hidden');
            buttonSpinner.classList.remove('hidden');
        }
        
        function hideLoading(buttonText, buttonSpinner) {
            buttonText.classList.remove('hidden');
            buttonSpinner.classList.add('hidden');
        }
        
        // Navigation Functions
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            
            // Show selected tab content
            document.getElementById(`${tabName}Section`).classList.remove('hidden');
            
            // Update active tab
            document.querySelectorAll('.nav-tab').forEach(tab => {
                if (tab.dataset.tab === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
        }
        
        function switchBottomNav(navItem) {
            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                if (item.dataset.nav === navItem) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            // Handle navigation based on nav item
            switch(navItem) {
                case 'home':
                case 'games':
                    switchTab('games');
                    break;
                case 'transfer':
                    switchTab('transfer');
                    break;
                case 'history':
                    switchTab('history');
                    loadTransactionHistory();
                    break;
                case 'profile':
                    switchTab('profile');
                    updateProfile();
                    break;
            }
        }
        
        // Update profile information
        function updateProfile() {
            if (!currentUser) return;
            
            profileUserName.textContent = currentUser.name || 'User Name';
            profileUserEmail.textContent = currentUser.email || 'user@example.com';
            profileGamesPlayed.textContent = currentUser.gamesPlayed || 0;
            profileWins.textContent = currentUser.wins || 0;
            profileReferrals.textContent = currentUser.referrals ? currentUser.referrals.length : 0;
            userReferralCode.value = currentUser.referralCode || 'SEE00000';
            
            // Update referral button
            const referralCount = currentUser.referrals ? currentUser.referrals.length : 0;
            referralsCount.textContent = referralCount;
            claimReferralBtn.textContent = `Claim Referral Bonus (${referralCount}/10)`;
            claimReferralBtn.disabled = referralCount < 10;
            
            // Update referral list
            updateReferralList();
            
            // Update price chart
            updatePriceChart();
        }
        
        // Update referral list
        function updateReferralList() {
            const referrals = currentUser.referrals || [];
            referralList.innerHTML = '';
            
            if (referrals.length === 0) {
                referralList.innerHTML = `
                    <div style="text-align: center; padding: 20px; opacity: 0.7;">
                        <i class="fas fa-user-friends" style="font-size: 40px; margin-bottom: 10px;"></i>
                        <div>No referrals yet</div>
                        <div style="font-size: 12px; margin-top: 5px;">Share your code to earn 3 SEE for every referral</div>
                    </div>
                `;
            } else {
                referrals.forEach(ref => {
                    const refItem = document.createElement('div');
                    refItem.className = 'referral-item';
                    refItem.innerHTML = `
                        <div>${ref.email}</div>
                        <div>${new Date(ref.date).toLocaleDateString()}</div>
                    `;
                    referralList.appendChild(refItem);
                });
            }
        }
        
        // Update price chart
        function updatePriceChart() {
            const ctx = document.getElementById('priceChart').getContext('2d');
            
            // Generate sample price data
            const labels = [];
            const data = [];
            let currentPrice = seePrice;
            
            for (let i = 0; i < 24; i++) {
                labels.push(`${i}:00`);
                // Simulate price fluctuations
                currentPrice += (Math.random() - 0.5) * 0.02;
                data.push(currentPrice);
            }
            
            if (priceChart) {
                priceChart.destroy();
            }
            
            priceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'SEE Price ($)',
                        data: data,
                        borderColor: '#00b0ff',
                        backgroundColor: 'rgba(0, 176, 255, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    }
                }
            });
        }
        
        // Generate unique referral code
        function generateReferralCode() {
            return 'SEE' + Math.random().toString(36).substring(2, 8).toUpperCase();
        }
        
        // Update user balance display
        function updateBalance() {
            document.getElementById('userBalance').textContent = `${userBalance.toFixed(2)} SEE`;
            document.getElementById('minesBalance').textContent = `${userBalance.toFixed(2)} SEE`;
            
            // Update USD value
            const usdAmount = (userBalance * seePrice).toFixed(2);
            usdValue.textContent = `$${usdAmount}`;
            
            // Update vault balance in admin panel
            document.getElementById('vaultBalance').textContent = `${adminVaultBalance.toLocaleString()} SEE`;
        }
        
        // Record transaction
        async function recordTransaction(type, category, amount, description) {
            if (!currentUser) return;
            
            const transaction = {
                type: type,
                category: category,
                amount: amount,
                description: description,
                timestamp: new Date(),
                userId: currentUser.uid
            };
            
            try {
                await db.collection('transactions').add(transaction);
                
                // Update user stats
                if (type === 'casino') {
                    await db.collection('users').doc(currentUser.uid).update({
                        gamesPlayed: firebase.firestore.FieldValue.increment(1),
                        wins: category === 'win' ? firebase.firestore.FieldValue.increment(1) : firebase.firestore.FieldValue.increment(0)
                    });
                }
                
                // Reload transaction history
                loadTransactionHistory();
            } catch (error) {
                console.error('Error recording transaction:', error);
            }
        }
        
        // Load transaction history
        async function loadTransactionHistory() {
            if (!currentUser) return;
            
            try {
                const snapshot = await db.collection('transactions')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('timestamp', 'desc')
                    .limit(20)
                    .get();
                
                transactionList.innerHTML = '';
                
                if (snapshot.empty) {
                    transactionList.innerHTML = `
                        <div style="text-align: center; padding: 20px; opacity: 0.7;">
                            <i class="fas fa-history" style="font-size: 40px; margin-bottom: 10px;"></i>
                            <div>No transactions yet</div>
                        </div>
                    `;
                    return;
                }
                
                snapshot.forEach(doc => {
                    const transaction = doc.data();
                    const transactionItem = document.createElement('div');
                    transactionItem.className = 'transaction-item';
                    
                    const amountClass = transaction.amount >= 0 ? 'positive' : 'negative';
                    const amountSign = transaction.amount >= 0 ? '+' : '';
                    
                    transactionItem.innerHTML = `
                        <div>
                            <div class="transaction-type">${transaction.type} - ${transaction.category}</div>
                            <div style="font-size: 12px; opacity: 0.8;">${transaction.description}</div>
                            <div style="font-size: 12px; opacity: 0.6;">${transaction.timestamp.toDate().toLocaleString()}</div>
                        </div>
                        <div class="transaction-amount ${amountClass}">${amountSign}${transaction.amount.toFixed(2)} SEE</div>
                    `;
                    
                    transactionList.appendChild(transactionItem);
                });
            } catch (error) {
                console.error('Error loading transactions:', error);
            }
        }
        
        // Update winning users display
        function updateWinningUsers(name, amount) {
            const userElement = document.createElement('div');
            userElement.className = 'winning-user';
            userElement.innerHTML = `
                <i class="fas fa-trophy"></i>
                <span>${name} won ${amount.toFixed(2)} SEE</span>
            `;
            
            winningUsers.appendChild(userElement);
            
            // Remove after 5 seconds
            setTimeout(() => {
                userElement.remove();
            }, 5000);
        }
        
        // Mines Game Logic
        function initializeMinesGame() {
            minesBetAmountDisplay.textContent = `${minesGameState.betAmount.toFixed(2)} SEE`;
            minesCount.textContent = minesGameState.minesCount;
            generateMinesGrid();
            updateMinesCashout();
        }
        
        function generateMinesGrid() {
            minesGrid.innerHTML = '';
            minesGameState.grid = [];
            minesGameState.revealed = [];
            minesGameState.gameActive = false;
            minesGameState.cashoutMultiplier = 1.0;
            minesGameState.multiplierHistory = [1.0];
            
            // Create 5x5 grid
            for (let i = 0; i < 25; i++) {
                const cell = document.createElement('div');
                cell.className = 'mine-cell';
                cell.dataset.index = i;
                cell.innerHTML = '';
                cell.addEventListener('click', () => revealMineCell(i));
                
                minesGrid.appendChild(cell);
                minesGameState.grid.push('gem'); // Start with all gems
            }
            
            // Place mines randomly
            let minesPlaced = 0;
            while (minesPlaced < minesGameState.minesCount) {
                const randomIndex = Math.floor(Math.random() * 25);
                if (minesGameState.grid[randomIndex] === 'gem') {
                    minesGameState.grid[randomIndex] = 'mine';
                    minesPlaced++;
                }
            }
            
            minesPlayButton.disabled = false;
            minesCashoutButton.disabled = true;
            minesMultiplierDisplay.textContent = 'Multiplier: 1.00x';
        }
        
        function calculateMinesMultiplier(safeTilesRevealed) {
            const totalTiles = 25;
            const mines = minesGameState.minesCount;
            const safeTiles = totalTiles - mines;
            
            if (safeTilesRevealed === 0) return 1.0;
            
            // Calculate multiplier using the formula
            let multiplier = 1.0;
            for (let i = 0; i < safeTilesRevealed; i++) {
                multiplier *= (totalTiles - i) / (safeTiles - i);
            }
            
            return parseFloat(multiplier.toFixed(2));
        }
        
        function revealMineCell(index) {
            if (!minesGameState.gameActive || minesGameState.revealed.includes(index)) {
                return;
            }
            
            minesGameState.revealed.push(index);
            const cell = minesGrid.children[index];
            cell.classList.add('revealed');
            
            if (minesGameState.grid[index] === 'mine') {
                // Hit a mine - game over
                cell.innerHTML = '';
                cell.classList.add('mine');
                minesGameState.gameActive = false;
                minesCashoutButton.disabled = true;
                
                // Reveal all mines
                for (let i = 0; i < 25; i++) {
                    if (minesGameState.grid[i] === 'mine' && !minesGameState.revealed.includes(i)) {
                        const mineCell = minesGrid.children[i];
                        mineCell.innerHTML = '';
                        mineCell.classList.add('mine');
                        mineCell.classList.add('revealed');
                    }
                }
                
                // Record transaction
                recordTransaction('casino', 'loss', -minesGameState.betAmount, 'Mines game loss');
                
                setTimeout(() => {
                    alert('Game Over! You hit a mine.');
                    initializeMinesGame();
                }, 2000);
            } else {
                // Found a gem
                cell.innerHTML = '';
                cell.classList.add('gem');
                
                // Calculate and update multiplier
                const safeTilesRevealed = minesGameState.revealed.filter(i => minesGameState.grid[i] === 'gem').length;
                minesGameState.cashoutMultiplier = calculateMinesMultiplier(safeTilesRevealed);
                minesGameState.multiplierHistory.push(minesGameState.cashoutMultiplier);
                
                updateMinesCashout();
                
                // Check if all gems are found
                const totalGems = 25 - minesGameState.minesCount;
                if (minesGameState.revealed.length === totalGems) {
                    // All gems found - auto cashout
                    cashoutMines();
                }
            }
        }
        
        function updateMinesCashout() {
            const cashoutAmount = (minesGameState.betAmount * minesGameState.cashoutMultiplier).toFixed(2);
            minesCashoutDisplay.textContent = `Cashout: ${cashoutAmount} SEE`;
            minesMultiplierDisplay.textContent = `Multiplier: ${minesGameState.cashoutMultiplier.toFixed(2)}x`;
        }
        
        async function startMinesGame() {
            if (userBalance < minesGameState.betAmount) {
                alert('Insufficient balance!');
                return;
            }
            
            // Deduct from user and add to vault
            userBalance -= minesGameState.betAmount;
            adminVaultBalance += minesGameState.betAmount;
            updateBalance();
            
            minesGameState.gameActive = true;
            minesPlayButton.disabled = true;
            minesCashoutButton.disabled = false;
            minesGameState.cashoutMultiplier = 1.0;
            minesGameState.multiplierHistory = [1.0];
            updateMinesCashout();
            
            // Record transaction
            await recordTransaction('casino', 'bet', -minesGameState.betAmount, 'Mines game bet');
        }
        
        async function cashoutMines() {
            const winAmount = minesGameState.betAmount * minesGameState.cashoutMultiplier;
            
            // Check if vault has enough funds
            if (adminVaultBalance < winAmount) {
                alert('Insufficient funds in vault!');
                return;
            }
            
            // Transfer from vault to user
            userBalance += winAmount;
            adminVaultBalance -= winAmount;
            updateBalance();
            
            minesCashoutButton.disabled = true;
            minesPlayButton.disabled = false;
            minesGameState.gameActive = false;
            
            // Record transaction
            await recordTransaction('casino', 'win', winAmount - minesGameState.betAmount, `Mines win with ${minesGameState.cashoutMultiplier.toFixed(2)}x multiplier`);
            
            // Update winning users display
            updateWinningUsers(currentUser.name, winAmount - minesGameState.betAmount);
            
            // Reveal all tiles
            for (let i = 0; i < 25; i++) {
                if (!minesGameState.revealed.includes(i)) {
                    const cell = minesGrid.children[i];
                    cell.classList.add('revealed');
                    if (minesGameState.grid[i] === 'mine') {
                        cell.innerHTML = '';
                        cell.classList.add('mine');
                    } else {
                        cell.innerHTML = '';
                        cell.classList.add('gem');
                    }
                }
            }
            
            setTimeout(() => {
                alert(`You cashed out ${winAmount.toFixed(2)} SEE!`);
                initializeMinesGame();
            }, 2000);
        }
        
        // Mines controls
        decreaseMines.addEventListener('click', () => {
            if (minesGameState.minesCount > 1) {
                minesGameState.minesCount--;
                minesCount.textContent = minesGameState.minesCount;
                generateMinesGrid();
            }
        });
        
        increaseMines.addEventListener('click', () => {
            if (minesGameState.minesCount < 24) {
                minesGameState.minesCount++;
                minesCount.textContent = minesGameState.minesCount;
                generateMinesGrid();
            }
        });
        
        decreaseBet.addEventListener('click', () => {
            if (minesGameState.betAmount > 1.00) {
                minesGameState.betAmount -= 1.00;
                minesBetAmountDisplay.textContent = `${minesGameState.betAmount.toFixed(2)} SEE`;
                updateMinesCashout();
            }
        });
        
        increaseBet.addEventListener('click', () => {
            if (minesGameState.betAmount < 100.00) {
                minesGameState.betAmount += 1.00;
                minesBetAmountDisplay.textContent = `${minesGameState.betAmount.toFixed(2)} SEE`;
                updateMinesCashout();
            }
        });
        
        // Game Functions
        function startGame(gameName) {
            currentGame = gameName;
            appScreen.classList.add('hidden');
            document.getElementById(`${gameName}Game`).classList.remove('hidden');
            gameScreens.classList.remove('hidden');
            
            // Update game balance
            document.getElementById('minesBalance').textContent = `${userBalance.toFixed(2)} SEE`;
            
            // Initialize specific game
            if (gameName === 'mines') {
                initializeMinesGame();
            }
        }
        
        function exitGame() {
            gameScreens.classList.add('hidden');
            appScreen.classList.remove('hidden');
            currentGame = null;
        }
        
        // Transfer function
        async function transferCoins() {
            const recipientEmail = transferEmail.value.trim();
            const amount = parseFloat(transferAmount.value);
            const pin = transferPin.value;
            
            if (!recipientEmail || !amount || !pin) {
                alert('Please fill in all fields');
                return;
            }
            
            if (amount < 1) {
                alert('Minimum transfer amount is 1 SEE');
                return;
            }
            
            if (userBalance < amount) {
                alert('Insufficient balance');
                return;
            }
            
            if (pin !== currentUser.pin) {
                alert('Invalid PIN');
                return;
            }
            
            try {
                // Find recipient user
                const usersSnapshot = await db.collection('users')
                    .where('email', '==', recipientEmail)
                    .get();
                
                if (usersSnapshot.empty) {
                    alert('Recipient not found');
                    return;
                }
                
                const recipientDoc = usersSnapshot.docs[0];
                const recipientData = recipientDoc.data();
                
                if (recipientData.banned) {
                    alert('Cannot transfer to banned user');
                    return;
                }
                
                // Update balances
                await db.collection('users').doc(currentUser.uid).update({
                    balance: firebase.firestore.FieldValue.increment(-amount)
                });
                
                await db.collection('users').doc(recipientDoc.id).update({
                    balance: firebase.firestore.FieldValue.increment(amount)
                });
                
                // Record transactions
                const transaction = {
                    type: 'transfer',
                    category: 'outgoing',
                    amount: -amount,
                    description: `Transfer to ${recipientEmail}`,
                    timestamp: new Date(),
                    userId: currentUser.uid,
                    recipientEmail: recipientEmail
                };
                
                await db.collection('transactions').add(transaction);
                
                const recipientTransaction = {
                    type: 'transfer',
                    category: 'incoming',
                    amount: amount,
                    description: `Transfer from ${currentUser.email}`,
                    timestamp: new Date(),
                    userId: recipientDoc.id,
                    senderEmail: currentUser.email
                };
                
                await db.collection('transactions').add(recipientTransaction);
                
                // Update local balance
                userBalance -= amount;
                updateBalance();
                
                // Clear form
                transferEmail.value = '';
                transferAmount.value = '';
                transferPin.value = '';
                
                alert(`Successfully transferred ${amount} SEE to ${recipientEmail}`);
                
                // Reload transaction history
                loadTransactionHistory();
            } catch (error) {
                console.error('Error transferring coins:', error);
                alert('Transfer failed. Please try again.');
            }
        }
        
        // Change PIN function
        async function changePin() {
            const currentPinValue = currentPin.value;
            const newPinValue = newPin.value;
            const confirmNewPinValue = confirmNewPin.value;
            
            if (!currentPinValue || !newPinValue || !confirmNewPinValue) {
                alert('Please fill in all fields');
                return;
            }
            
            if (currentPinValue !== currentUser.pin) {
                alert('Current PIN is incorrect');
                return;
            }
            
            if (newPinValue !== confirmNewPinValue) {
                alert('New PINs do not match');
                return;
            }
            
            if (newPinValue.length !== 4 || isNaN(newPinValue)) {
                alert('PIN must be 4 digits');
                return;
            }
            
            try {
                await db.collection('users').doc(currentUser.uid).update({
                    pin: newPinValue
                });
                
                currentUser.pin = newPinValue;
                
                // Clear form
                currentPin.value = '';
                newPin.value = '';
                confirmNewPin.value = '';
                
                alert('PIN changed successfully');
            } catch (error) {
                console.error('Error changing PIN:', error);
                alert('Failed to change PIN. Please try again.');
            }
        }
        
        // Claim referral bonus
        async function claimReferralBonus() {
            const referralCount = currentUser.referrals ? currentUser.referrals.length : 0;
            
            if (referralCount < 10) {
                alert('You need at least 10 referrals to claim the bonus');
                return;
            }
            
            // Check if vault has enough funds
            if (adminVaultBalance < 3) {
                alert('Insufficient funds in vault!');
                return;
            }
            
            try {
                // Transfer from vault to user
                await db.collection('users').doc(currentUser.uid).update({
                    balance: firebase.firestore.FieldValue.increment(3)
                });
                
                // Update vault balance
                adminVaultBalance -= 3;
                
                // Update local balance
                userBalance += 3;
                updateBalance();
                
                // Record transaction
                await recordTransaction('referral', 'bonus', 3, 'Referral bonus');
                
                alert('Referral bonus of 3 SEE has been added to your account!');
            } catch (error) {
                console.error('Error claiming referral bonus:', error);
                alert('Failed to claim bonus. Please try again.');
            }
        }
        
        // Claim signup bonus
        async function claimSignupBonus() {
            if (currentUser.bonusClaimed) {
                alert('You have already claimed your signup bonus');
                return;
            }
            
            // Check if vault has enough funds
            if (adminVaultBalance < 3) {
                alert('Insufficient funds in vault!');
                return;
            }
            
            try {
                // Transfer from vault to user
                await db.collection('users').doc(currentUser.uid).update({
                    balance: firebase.firestore.FieldValue.increment(3),
                    bonusClaimed: true
                });
                
                // Update vault balance
                adminVaultBalance -= 3;
                
                // Update local balance
                userBalance += 3;
                updateBalance();
                
                // Record transaction
                await recordTransaction('bonus', 'signup', 3, 'Signup bonus');
                
                alert('Signup bonus of 3 SEE has been added to your account!');
                claimBonusBtn.disabled = true;
            } catch (error) {
                console.error('Error claiming signup bonus:', error);
                alert('Failed to claim bonus. Please try again.');
            }
        }
        
        // Admin Functions
        async function loadAdminPanel() {
            try {
                const usersSnapshot = await db.collection('users').get();
                usersList.innerHTML = '';
                
                if (usersSnapshot.empty) {
                    usersList.innerHTML = '<div style="text-align: center; padding: 20px; opacity: 0.7;">No users registered yet</div>';
                    return;
                }
                
                let totalUserBalance = 0;
                let activeGamesCount = 0;
                
                usersSnapshot.forEach(doc => {
                    const user = doc.data();
                    totalUserBalance += user.balance || 0;
                    
                    const userItem = document.createElement('div');
                    userItem.className = 'user-item';
                    userItem.innerHTML = `
                        <div class="user-info">
                            <div class="user-name">${user.name} ${user.banned ? '(BANNED)' : ''}</div>
                            <div class="user-email">${user.email}</div>
                        </div>
                        <div class="user-balance">${(user.balance || 0).toFixed(2)} SEE</div>
                        <div class="user-actions">
                            <button class="user-action" data-user-id="${doc.id}" data-user-email="${user.email}" title="Add Coins"><i class="fas fa-coins"></i></button>
                            <button class="user-action" data-user-id="${doc.id}" data-user-email="${user.email}" title="${user.banned ? 'Unban' : 'Ban'} User"><i class="fas fa-ban"></i></button>
                            <button class="user-action" data-user-id="${doc.id}" data-user-email="${user.email}" title="Message User"><i class="fas fa-envelope"></i></button>
                        </div>
                    `;
                    usersList.appendChild(userItem);
                });
                
                // Update admin stats
                document.getElementById('totalUsers').textContent = usersSnapshot.size;
                document.getElementById('totalBalance').textContent = `${totalUserBalance.toFixed(2)} SEE`;
                document.getElementById('activeGames').textContent = activeGamesCount;
                document.getElementById('vaultBalance').textContent = `${adminVaultBalance.toLocaleString()} SEE`;
                
                // Add event listeners to user action buttons
                document.querySelectorAll('.user-action').forEach(button => {
                    button.addEventListener('click', function() {
                        const userId = this.dataset.userId;
                        const userEmail = this.dataset.userEmail;
                        
                        if (this.querySelector('.fa-coins')) {
                            addCoinsToUser(userId, userEmail);
                        } else if (this.querySelector('.fa-ban')) {
                            toggleBanUser(userId, userEmail);
                        } else if (this.querySelector('.fa-envelope')) {
                            messageUser(userId, userEmail);
                        }
                    });
                });
            } catch (error) {
                console.error('Error loading admin panel:', error);
            }
        }
        
        async function addCoinsToUser(userId, userEmail) {
            const amount = parseFloat(prompt(`Enter amount of SEE to add to ${userEmail}:`));
            if (!amount || isNaN(amount) || amount <= 0) {
                alert('Invalid amount!');
                return;
            }
            
            // Check if vault has enough funds
            if (adminVaultBalance < amount) {
                alert('Insufficient funds in vault!');
                return;
            }
            
            try {
                await db.collection('users').doc(userId).update({
                    balance: firebase.firestore.FieldValue.increment(amount)
                });
                
                // Update vault balance
                adminVaultBalance -= amount;
                document.getElementById('vaultBalance').textContent = `${adminVaultBalance.toLocaleString()} SEE`;
                
                // Record transaction
                const transaction = {
                    type: 'admin',
                    category: 'credit',
                    amount: amount,
                    description: `Admin credit to ${userEmail}`,
                    timestamp: new Date(),
                    userId: userId,
                    adminEmail: 'ebubechichukwu8@gmail.com'
                };
                
                await db.collection('transactions').add(transaction);
                
                alert(`Added ${amount} SEE to ${userEmail}`);
                
                // Reload admin panel
                loadAdminPanel();
            } catch (error) {
                console.error('Error adding coins:', error);
                alert('Failed to add coins. Please try again.');
            }
        }
        
        async function toggleBanUser(userId, userEmail) {
            try {
                const userDoc = await db.collection('users').doc(userId).get();
                const userData = userDoc.data();
                const currentlyBanned = userData.banned || false;
                
                if (currentlyBanned) {
                    await db.collection('users').doc(userId).update({
                        banned: false
                    });
                    alert(`Unbanned ${userEmail}`);
                } else {
                    // If banning, transfer user's balance to vault
                    if (userData.balance > 0) {
                        adminVaultBalance += userData.balance;
                        document.getElementById('vaultBalance').textContent = `${adminVaultBalance.toLocaleString()} SEE`;
                    }
                    
                    await db.collection('users').doc(userId).update({
                        banned: true,
                        balance: 0
                    });
                    alert(`Banned ${userEmail} and transferred ${userData.balance} SEE to vault`);
                }
                
                // Reload admin panel
                loadAdminPanel();
            } catch (error) {
                console.error('Error toggling ban:', error);
                alert('Failed to update user status. Please try again.');
            }
        }
        
        async function messageUser(userId, userEmail) {
            const message = prompt(`Enter message to send to ${userEmail}:`);
            if (!message) return;
            
            try {
                const messageData = {
                    from: 'admin',
                    fromEmail: 'ebubechichukwu8@gmail.com',
                    to: userId,
                    toEmail: userEmail,
                    message: message,
                    timestamp: new Date(),
                    read: false
                };
                
                await db.collection('messages').add(messageData);
                alert('Message sent successfully');
            } catch (error) {
                console.error('Error sending message:', error);
                alert('Failed to send message. Please try again.');
            }
        }
        
        async function setSeePrice() {
            const newPrice = parseFloat(prompt('Enter new SEE price in USD:'));
            if (!newPrice || isNaN(newPrice) || newPrice <= 0) {
                alert('Invalid price!');
                return;
            }
            
            seePrice = newPrice;
            
            try {
                await db.collection('settings').doc('seePrice').set({
                    price: seePrice,
                    updatedAt: new Date(),
                    updatedBy: 'ebubechichukwu8@gmail.com'
                });
                
                alert(`SEE price set to $${seePrice}`);
                updateBalance();
            } catch (error) {
                console.error('Error setting SEE price:', error);
                alert('Failed to set price. Please try again.');
            }
        }
        
        // Load SEE price from Firebase
        async function loadSeePrice() {
            try {
                const priceDoc = await db.collection('settings').doc('seePrice').get();
                if (priceDoc.exists) {
                    seePrice = priceDoc.data().price;
                }
                updateBalance();
            } catch (error) {
                console.error('Error loading SEE price:', error);
            }
        }
        
        // Event Listeners for Navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                switchTab(tab.dataset.tab);
            });
        });
        
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                switchBottomNav(item.dataset.nav);
            });
        });
        
        // Game card clicks
        document.querySelectorAll('.game-card').forEach(card => {
            card.addEventListener('click', () => {
                const gameName = card.dataset.game;
                startGame(gameName);
            });
        });
        
        // Game controls
        minesPlayButton.addEventListener('click', startMinesGame);
        minesCashoutButton.addEventListener('click', cashoutMines);
        minesBackBtn.addEventListener('click', exitGame);
        
        // Transfer controls
        transferButton.addEventListener('click', transferCoins);
        
        // Profile controls
        copyReferralBtn.addEventListener('click', () => {
            userReferralCode.select();
            document.execCommand('copy');
            alert('Referral code copied to clipboard!');
        });
        
        claimReferralBtn.addEventListener('click', claimReferralBonus);
        changePinButton.addEventListener('click', changePin);
        claimBonusBtn.addEventListener('click', claimSignupBonus);
        
        // Admin controls
        addCoinsBtn.addEventListener('click', () => {
            // This will now use the user-specific buttons
        });
        
        banUserBtn.addEventListener('click', () => {
            // This will now use the user-specific buttons
        });
        
        messageUserBtn.addEventListener('click', () => {
            // This will now use the user-specific buttons
        });
        
        setPriceBtn.addEventListener('click', setSeePrice);
        
        // Auth Event Listeners
        showRegister.addEventListener('click', (e) => {
            e.preventDefault();
            showScreen(registerScreen);
        });
        
        showLogin.addEventListener('click', (e) => {
            e.preventDefault();
            showScreen(loginScreen);
        });
        
        showAdminLogin.addEventListener('click', (e) => {
            e.preventDefault();
            showScreen(adminLoginScreen);
        });
        
        showUserLogin.addEventListener('click', (e) => {
            e.preventDefault();
            showScreen(loginScreen);
        });
        
        // Login function
        loginButton.addEventListener('click', async () => {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('Please enter both email and password');
                return;
            }
            
            showLoading(loginButtonText, loginButtonSpinner);
            
            try {
                // Check if admin login
                if (email === 'ebubechichukwu8@gmail.com' && password === 'Ebube@123') {
                    isAdmin = true;
                    showScreen(adminPanel);
                    await loadAdminPanel();
                    await loadSeePrice();
                    hideLoading(loginButtonText, loginButtonSpinner);
                    return;
                }
                
                // Regular user login with Firebase Auth
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                // Get user data from Firestore
                const userDoc = await db.collection('users').doc(user.uid).get();
                
                if (!userDoc.exists) {
                    alert('User data not found');
                    hideLoading(loginButtonText, loginButtonSpinner);
                    return;
                }
                
                const userData = userDoc.data();
                
                if (userData.banned) {
                    alert('Your account has been banned');
                    await auth.signOut();
                    hideLoading(loginButtonText, loginButtonSpinner);
                    return;
                }
                
                currentUser = {
                    uid: user.uid,
                    ...userData
                };
                
                userBalance = userData.balance || 0;
                
                updateBalance();
                updateProfile();
                await loadTransactionHistory();
                await loadSeePrice();
                
                showScreen(appScreen);
            } catch (error) {
                console.error('Login error:', error);
                alert('Login failed: ' + error.message);
            }
            
            hideLoading(loginButtonText, loginButtonSpinner);
        });
        
        // Register function
        registerButton.addEventListener('click', async () => {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            const pin = document.getElementById('registerPin').value;
            const age = document.getElementById('registerAge').value;
            const country = document.getElementById('registerCountry').value;
            const referralCode = document.getElementById('referralCodeInput').value;
            
            if (!name || !email || !password || !confirmPassword || !pin || !age || !country) {
                alert('Please fill in all required fields');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('Passwords do not match');
                return;
            }
            
            if (pin.length !== 4 || isNaN(pin)) {
                alert('PIN must be 4 digits');
                return;
            }
            
            if (parseInt(age) < 17) {
                alert('You must be at least 17 years old to register');
                return;
            }
            
            showLoading(registerButtonText, registerButtonSpinner);
            
            try {
                // Create user with Firebase Auth
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                // Generate referral code
                const referralCodeGenerated = generateReferralCode();
                
                // Create user document in Firestore
                const userData = {
                    uid: user.uid,
                    name: name,
                    email: email,
                    pin: pin,
                    age: parseInt(age),
                    country: country,
                    balance: 0,
                    referralCode: referralCodeGenerated,
                    referrals: [],
                    gamesPlayed: 0,
                    wins: 0,
                    bonusClaimed: false,
                    banned: false,
                    createdAt: new Date()
                };
                
                await db.collection('users').doc(user.uid).set(userData);
                
                // Handle referral if provided
                if (referralCode) {
                    const referrerSnapshot = await db.collection('users')
                        .where('referralCode', '==', referralCode)
                        .get();
                    
                    if (!referrerSnapshot.empty) {
                        const referrerDoc = referrerSnapshot.docs[0];
                        const referrerData = referrerDoc.data();
                        
                        // Add referral to referrer's list
                        await db.collection('users').doc(referrerDoc.id).update({
                            referrals: firebase.firestore.FieldValue.arrayUnion({
                                email: email,
                                date: new Date()
                            })
                        });
                        
                        // Credit referrer with 3 SEE
                        await db.collection('users').doc(referrerDoc.id).update({
                            balance: firebase.firestore.FieldValue.increment(3)
                        });
                        
                        // Record transaction for referrer
                        const transaction = {
                            type: 'referral',
                            category: 'bonus',
                            amount: 3,
                            description: `Referral bonus for ${email}`,
                            timestamp: new Date(),
                            userId: referrerDoc.id
                        };
                        
                        await db.collection('transactions').add(transaction);
                    }
                }
                
                currentUser = userData;
                userBalance = 0;
                
                updateBalance();
                updateProfile();
                await loadSeePrice();
                
                showScreen(appScreen);
                alert('Registration successful! You can now claim your signup bonus.');
            } catch (error) {
                console.error('Registration error:', error);
                alert('Registration failed: ' + error.message);
            }
            
            hideLoading(registerButtonText, registerButtonSpinner);
        });
        
        // Admin login
        adminLoginButton.addEventListener('click', async () => {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            
            if (!email || !password) {
                alert('Please enter both email and password');
                return;
            }
            
            showLoading(adminLoginButtonText, adminLoginButtonSpinner);
            
            if (email === 'ebubechichukwu8@gmail.com' && password === 'Ebube@123') {
                isAdmin = true;
                showScreen(adminPanel);
                await loadAdminPanel();
                await loadSeePrice();
            } else {
                alert('Invalid admin credentials!');
            }
            
            hideLoading(adminLoginButtonText, adminLoginButtonSpinner);
        });
        
        // Logout functions
        logoutButton.addEventListener('click', async () => {
            if (confirm('Are you sure you want to logout?')) {
                await auth.signOut();
                userBalance = 0;
                currentUser = null;
                showScreen(loginScreen);
            }
        });
        
        adminLogoutButton.addEventListener('click', () => {
            if (confirm('Are you sure you want to logout from admin panel?')) {
                isAdmin = false;
                showScreen(loginScreen);
            }
        });
        
        // Initialize app
        showScreen(loginScreen);
        
        // Check if user is already logged in
        auth.onAuthStateChanged(async (user) => {
            if (user && !isAdmin) {
                try {
                    const userDoc = await db.collection('users').doc(user.uid).get();
                    
                    if (userDoc.exists) {
                        const userData = userDoc.data();
                        
                        if (userData.banned) {
                            alert('Your account has been banned');
                            await auth.signOut();
                            return;
                        }
                        
                        currentUser = {
                            uid: user.uid,
                            ...userData
                        };
                        
                        userBalance = userData.balance || 0;
                        
                        updateBalance();
                        updateProfile();
                        await loadTransactionHistory();
                        await loadSeePrice();
                        
                        showScreen(appScreen);
                    }
                } catch (error) {
                    console.error('Error loading user data:', error);
                }
            }
        });
    </script>
</body>
</html>
